[32m2022-12-02 17:26:50 -0500[0m - dagster - [34mDEBUG[0m - matriz_data - 3c275249-5b08-4fd9-8486-897c045c0e4e - 37913 - LOGS_CAPTURED - Started capturing logs in process (pid: 37913).
[32m2022-12-02 17:26:50 -0500[0m - dagster - [34mDEBUG[0m - matriz_data - 3c275249-5b08-4fd9-8486-897c045c0e4e - 37913 - load_table - STEP_START - Started execution of step "load_table".
[32m2022-12-02 17:26:55 -0500[0m - dagster - [34mERROR[0m - [31mmatriz_data - 3c275249-5b08-4fd9-8486-897c045c0e4e - 37913 - load_table - STEP_FAILURE - Execution of step "load_table" failed.

dagster._core.errors.DagsterExecutionStepExecutionError: Error occurred while executing op "load_table"::

sqlalchemy.exc.OperationalError: (psycopg2.errors.ObjectInUse) database "matrizdb" is being accessed by other users
DETAIL:  There is 1 other session using the database.

[SQL: DROP DATABASE IF EXISTS matrizdb;]
(Background on this error at: https://sqlalche.me/e/14/e3q8)

Stack Trace:
  File "/Users/fabio/miniforge3/envs/dagsterETL/lib/python3.9/site-packages/dagster/_core/execution/plan/utils.py", line 47, in solid_execution_error_boundary
    yield
  File "/Users/fabio/miniforge3/envs/dagsterETL/lib/python3.9/site-packages/dagster/_utils/__init__.py", line 447, in iterate_with_context
    next_output = next(iterator)
  File "/Users/fabio/miniforge3/envs/dagsterETL/lib/python3.9/site-packages/dagster/_core/execution/plan/compute_generator.py", line 74, in _coerce_solid_compute_fn_to_iterator
    result = fn(context, **kwargs) if context_arg_provided else fn(**kwargs)
  File "/Users/fabio/Documents/dagster_home/etldagster/etldagster/ops/etl.py", line 9, in load_table
    conn = create_database()
  File "/Users/fabio/Documents/dagster_home/etldagster/etldagster/create_db.py", line 15, in create_database
    conn.execute("DROP DATABASE IF EXISTS matrizdb;")
  File "/Users/fabio/miniforge3/envs/dagsterETL/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1365, in execute
    return self._exec_driver_sql(
  File "/Users/fabio/miniforge3/envs/dagsterETL/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1669, in _exec_driver_sql
    ret = self._execute_context(
  File "/Users/fabio/miniforge3/envs/dagsterETL/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1943, in _execute_context
    self._handle_dbapi_exception(
  File "/Users/fabio/miniforge3/envs/dagsterETL/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 2124, in _handle_dbapi_exception
    util.raise_(
  File "/Users/fabio/miniforge3/envs/dagsterETL/lib/python3.9/site-packages/sqlalchemy/util/compat.py", line 210, in raise_
    raise exception
  File "/Users/fabio/miniforge3/envs/dagsterETL/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "/Users/fabio/miniforge3/envs/dagsterETL/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)

The above exception was caused by the following exception:
psycopg2.errors.ObjectInUse: database "matrizdb" is being accessed by other users
DETAIL:  There is 1 other session using the database.


Stack Trace:
  File "/Users/fabio/miniforge3/envs/dagsterETL/lib/python3.9/site-packages/sqlalchemy/engine/base.py", line 1900, in _execute_context
    self.dialect.do_execute(
  File "/Users/fabio/miniforge3/envs/dagsterETL/lib/python3.9/site-packages/sqlalchemy/engine/default.py", line 736, in do_execute
    cursor.execute(statement, parameters)
[0m
